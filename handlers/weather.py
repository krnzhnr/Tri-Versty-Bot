import datetime

from aiogram import Dispatcher, types
from aiogram.dispatcher import FSMContext
from aiogram.dispatcher.filters.state import State, StatesGroup
from create_bot import bot, dp
from pyowm import OWM
from pyowm.utils import config

config_dict = config.get_default_config_for_subscription_type('professional')
config_dict['language'] = 'ru' 

owm = OWM('127934e41dc5667bf248c54d9435ea1a', config_dict)
mgr = owm.weather_manager()

class FSMWeather(StatesGroup):
    city = State()


# @dp.message_handler(commands=['–ü–æ–≥–æ–¥–∞'], state=None)
async def weather(message: types.Message, state:FSMContext):
    nowdatetime = datetime.datetime.now()
    now = nowdatetime.strftime('[%d/%m/%Y %H:%M:%S]')
    try:
        await FSMWeather.city.set()
        await message.answer('–ù–∞–ø–∏—à–∏ –º–Ω–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞, –≤ –∫–æ—Ç–æ—Ä–æ–º —Ç—ã —Ö–æ—á–µ—à—å —É–∑–Ω–∞—Ç—å –ø–æ–≥–æ–¥—É.')
    except Exception as exc:
        print(now, exc)
        await state.finish()


# @dp.message_handler(content_types=['text'], state=FSMWeather.city)
async def city(message: types.Message, state:FSMContext):
    nowdatetime = datetime.datetime.now()
    now = nowdatetime.strftime('[%d/%m/%Y %H:%M:%S]')
    async with state.proxy() as data:
        data['city'] = message.text
    try:
        observation = mgr.weather_at_place(str(message.text))
        w = observation.weather
        a = w.detailed_status
        # b = w.wind() 
        c = ("–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–∞ –≥—Ä–∞–¥—É—Å–Ω–∏–∫–µ: " 
             + "\n"  + str(w.temperature('celsius')['temp'])  + "¬∞–°" 
             + "\n\n–ü–æ –æ—â—É—â–µ–Ω–∏—é: " 
             + '\n' + str(w.temperature('celsius')['feels_like']) + "¬∞–°")
        d = (w.temperature('celsius')['feels_like'])
        # e = w.rain
        # f = w.clouds

        # current_temp = w.temperature ('celsius')["temp"]

        # await message.answer (w.detailed_status, w.wind, w.humidity, parse_mode=True) 
        # await bot.send_message(message_filter, message.text)
        # await message.answer (w.detailed_status)         # 'clouds'
        # w.detailed_status
        # w.wind()                  # {'speed': 4.6, 'deg': 330}

        # await message.answer (w.humidity)                # 87
        # w.humidity
        # await message.answer ("–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–∞ –≥—Ä–∞–¥—É—Å–Ω–∏–∫–µ: " + str(w.temperature('celsius')['temp']) + "¬∞–°" + "\n–ü–æ –æ—â—É—â–µ–Ω–∏—é: " + str(w.temperature('celsius')['feels_like']) + "¬∞–°")  # {'temp_max': 10.5, 'temp': 9.7, 'temp_min': 9.0, 'feels_like': 1.43}
        # await message.answer("<u>egbegb</u> " + str(w.temperature('celsius')['temp']))

        if d < 20 and \
            d >= 15:
            d = ("""
–ü—Ä–∏ —Ç–∞–∫–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ –≤–ø–æ–ª–Ω–µ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ –º–æ–∂–Ω–æ –µ–∑–¥–∏—Ç—å –∏ –≤ –ª–µ—Ç–Ω–µ–π —Ñ–æ—Ä–º–µ, \
–¥–æ–±–∞–≤–∏–≤ —Å–Ω–∞—á–∞–ª–∞ —Ä—É–∫–∞–≤–∞ (–æ–∫–æ–ª–æ +17-18 –≥—Ä–∞–¥—É—Å–æ–≤), –∞ –∑–∞—Ç–µ–º –∏ ¬´—á—É–ª–∫–∏¬ª, –µ—Å–ª–∏ —Å—Ç–æ–ª–±–∏–∫ —Ç–µ—Ä–º–æ–º–µ—Ç—Ä–∞ –ø—Ä–∏–±–ª–∏–∂–∞–µ—Ç—Å—è –∫ +15¬∞–°.

–í —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ, –∫–∞–∫ —Ç–æ–ª—å–∫–æ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è –¥–æ 20 –≥—Ä–∞–¥—É—Å–æ–≤ –∏ –≤—ã—à–µ, \
–≤—ã –ª–µ–≥–∫–∏–º –¥–≤–∏–∂–µ–Ω–∏–µ–º —Å–Ω–∏–º–∞–µ—Ç–µ —Ä—É–∫–∞–≤–∞, —á—É–ª–∫–∏ –∏ —á—É–≤—Å—Ç–≤—É–µ—Ç–µ —Å–µ–±—è —Å—É—Ö–æ –∏ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ.

–ï—â–µ –æ–¥–Ω–æ –ø–æ–ª–µ–∑–Ω–æ–µ –ø—Ä–∏–æ–±—Ä–µ—Ç–µ–Ω–∏–µ –≤ –ø—Ä–æ—Ö–ª–∞–¥–Ω—É—é –≤–µ—Ç—Ä–µ–Ω—É—é –ø–æ–≥–æ–¥—É, \
–æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –≤–ª–∞–∂–Ω–æ—Å—Ç–∏, –∫–æ–≥–¥–∞ –≤–µ—Ç–µ—Ä –ø—Ä–æ–º–æ—Ä–∞–∂–∏–≤–∞–µ—Ç –Ω–∞—Å–∫–≤–æ–∑—å –¥–∞–∂–µ \
–ø—Ä–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –≤—ã—Å–æ–∫–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ ‚Äì –∂–∏–ª–µ—Ç–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –∑–∞—â–∏—Ç–∏—Ç –≤–∞—à–µ —Ç–µ–ª–æ –æ—Ç –ª–∏—à–Ω–µ–≥–æ –ø–µ—Ä–µ–æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è.
""")
        elif d < 15 and \
            d >= 10:
            d = ("""
–ü—Ä–∏–≤–µ–¥–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–±–æ—á–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤, –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –≤—ã –≤—Å–µ–≥–¥–∞ —Å–º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å –Ω–∞–∏–±–æ–ª–µ–µ –≤–∞–º –ø–æ–¥—Ö–æ–¥—è—â–∏–π.

–í–µ—Ä—Ö:

1. –î–∂–µ—Ä—Å–∏ —Å –∫–æ—Ä–æ—Ç–∫–∏–º —Ä—É–∫–∞–≤–æ–º –Ω–∞ —Ç–µ—Ä–º–æ–º–∞–π–∫—É —Å –¥–ª–∏–Ω–Ω—ã–º —Ä—É–∫–∞–≤–æ–º. –ñ–∏–ª–µ—Ç–∫–∞ –≤ –∫–∞—Ä–º–∞–Ω–µ –¥–∂–µ—Ä—Å–∏ ‚Äî –Ω–∞ —Å–ª—É—á–∞–π —Ö–æ–ª–æ–¥–Ω–æ–≥–æ –≤–µ—Ç—Ä–∞.
2. –î–∂–µ—Ä—Å–∏ —Å –¥–ª–∏–Ω–Ω—ã–º —Ä—É–∫–∞–≤–æ–º, —Ç–µ—Ä–º–æ–º–∞–π–∫–∞ –ø–æ–¥ –Ω–µ–µ —Å –¥–ª–∏–Ω–Ω—ã–º –∏–ª–∏ –∫–æ—Ä–æ—Ç–∫–∏–º —Ä—É–∫–∞–≤–æ–º –ø–æ –≤–∫—É—Å—É. –ñ–∏–ª–µ—Ç–∫–∞ –≤ –∫–∞—Ä–º–∞–Ω–µ.
3. –î–∂–µ—Ä—Å–∏ —Å –∫–æ—Ä–æ—Ç–∫–∏–º —Ä—É–∫–∞–≤–æ–º, —Ç–µ—Ä–º–æ–º–∞–π–∫–∞ –ø–æ–¥ –Ω–µ–µ —Å –∫–æ—Ä–æ—Ç–∫–∏–º —Ä—É–∫–∞–≤–æ–º –∏ —Ñ–ª–∏—Å–æ–≤—ã–µ —Ä—É–∫–∞–≤–∞ –æ—Ç–¥–µ–ª—å–Ω–æ. –ñ–∏–ª–µ—Ç–∫–∞ –≤ –∫–∞—Ä–º–∞–Ω–µ.

–ù–∏–∑:

1. –¢–µ–ø–ª—ã–µ –Ω–∞–∫–æ–ª–µ–Ω–Ω–∏–∫–∏ + –ª–µ—Ç–Ω–∏–µ —Ç—Ä—É—Å—ã —Å –ø–∞–º–ø–µ—Ä—Å–æ–º.
2. –í–µ–ª–æ—Ç—Ä—É—Å—ã –≤ 3/4 (—á—É—Ç—å –Ω–∏–∂–µ –∫–æ–ª–µ–Ω–∞).
3. ¬´–ß—É–ª–∫–∏¬ª + –ª–µ—Ç–Ω–∏–µ —Ç—Ä—É—Å—ã —Å –ø–∞–º–ø–µ—Ä—Å–æ–º.
4. –ë–ª–∏–∂–µ –∫ 10 –≥—Ä–∞–¥—É—Å–∞–º ‚Äì –¥–ª–∏–Ω–Ω—ã–µ –≤–µ–ª–æ—à—Ç–∞–Ω—ã –±–µ–∑ –≤–∏–Ω–¥—Å—Ç–æ–ø–ø–µ—Ä–∞.

–ü–µ—Ä—á–∞—Ç–∫–∏:

1. –ù–∞ —Ç–∞–∫—É—é –ø–æ–≥–æ–¥—É —Å—Ç–æ–∏—Ç –∏–º–µ—Ç—å –ª–µ–≥–∫–∏–µ –ø–µ—Ä—á–∞—Ç–∫–∏ —Å –¥–ª–∏–Ω–Ω—ã–º–∏ –ø–∞–ª—å—Ü–∞–º–∏
2. –ë–ª–∏–∂–µ –∫ 10 –≥—Ä–∞–¥—É—Å–∞–º ‚Äì –ø–µ—Ä—á–∞—Ç–∫–∏ —Å –¥–ª–∏–Ω–Ω—ã–º –ø–∞–ª—å—Ü–µ–º –∏ –≤–∏–Ω–¥—Å—Ç–æ–ø–ø–µ—Ä–æ–º, –Ω–æ –±–µ–∑ —É—Ç–µ–ø–ª–µ–Ω–∏—è.

–¢—É—Ñ–ª–∏:

–ë–ª–∏–∂–µ –∫ 10 –≥—Ä–∞–¥—É—Å–∞–º —Å—Ç–æ–∏—Ç —É—Ç–µ–ø–ª–∏—Ç—å —Ç—É—Ñ–ª–∏ –ª–µ–≥–∫–∏–º–∏ –±–∞—Ö–∏–ª–∞–º–∏

–ó–∞—â–∏—Ç–∞ –≥–æ–ª–æ–≤—ã:

–ë–ª–∏–∂–µ –∫ 10 –≥—Ä–∞–¥—É—Å–∞–º —Å—Ç–æ–∏—Ç –Ω–∞–¥–µ–≤–∞—Ç—å –ø–æ–¥ —à–ª–µ–º –ª–µ–≥–∫—É—é —à–∞–ø–æ—á–∫—É —Å –≤–∏–Ω–¥—Å—Ç–æ–ø–ø–µ—Ä–æ–º –Ω–∞ –ª–±—É –ø–æ–¥ —à–ª–µ–º.
""")
        elif d < 10 and \
            d >= 5:
            d = ("""
–í–µ—Ä—Ö:

–ò–¥–µ–∞–ª—å–Ω–∞—è –æ–¥–µ–∂–¥–∞ –¥–ª—è —Ç–∞–∫–æ–π –ø–æ–≥–æ–¥—ã ‚Äì –∫—É—Ä—Ç–∫–∞ —Å –Ω–µ–ø—Ä–æ–¥—É–≤–∞–µ–º–æ–π –≥—Ä—É–¥—å—é, \
—Ä—É–∫–∞–≤–∞–º–∏ –∏ –ø–ª–µ—á–∞–º–∏, –Ω–æ –±–µ–∑ —É—Ç–µ–ø–ª–∏—Ç–µ–ª—è. –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–∏ —ç—Ç–æ–º, –æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ –µ–∑–¥–µ –Ω–∞ –ú–¢–ë –≤ –ª–µ—Å—É, —á—Ç–æ–±—ã ¬´–¥—ã—à–∞–ª–∞¬ª —Å–ø–∏–Ω–∞.

–ù–∏–∑:

–î–ª–∏–Ω–Ω—ã–µ –≤–µ–ª–æ—à—Ç–∞–Ω—ã —Å –ª–µ–≥–∫–∏–º —É—Ç–µ–ø–ª–µ–Ω–∏–µ–º, –Ω–∞–ª–∏—á–∏–µ –∑–∞—â–∏—â–∞—é—â–µ–≥–æ –æ—Ç —Ö–æ–ª–æ–¥–Ω–æ–≥–æ –≤–µ—Ç—Ä–∞ \
—Å–ª–æ—è –≤ —Ä–∞–π–æ–Ω–µ –∫–æ–ª–µ–Ω–µ–π –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ—Ç—Å—è. –ú–æ–∂–Ω–æ –∫—É–ø–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ —Ç–µ–ø–ª—ã–µ –Ω–∞–∫–æ–ª–µ–Ω–Ω–∏–∫–∏ —Å –≤–∏–Ω–¥—Å—Ç–æ–ø–ø–µ—Ä–æ–º.

–ü–µ—Ä—á–∞—Ç–∫–∏:

–í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–µ—Ä–º–æ—Ä–µ–≥—É–ª—è—Ü–∏–∏ –≤–∞—à–µ–≥–æ –æ—Ä–≥–∞–Ω–∏–∑–º–∞, –≤–∞–º –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ –ø–æ–¥–æ–π–¥—É—Ç \
–ª–∏–±–æ –ø–µ—Ä—á–∞—Ç–∫–∏ —Å –≤–∏–Ω–¥—Å—Ç–æ–ø–ø–µ—Ä–æ–º, –Ω–æ –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —É—Ç–µ–ø–ª–µ–Ω–∏—è, –ª–∏–±–æ —Å –ª–µ–≥–∫–∏–º —É—Ç–µ–ø–ª–µ–Ω–∏–µ–º. –ù–æ –Ω–µ —Å–æ–≤—Å–µ–º ¬´–∑–∏–º–Ω–∏–µ¬ª.

–¢—É—Ñ–ª–∏:

1. –°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –≤–∞—Ä–∏–∞–Ω—Ç ‚Äì –±–∞—Ö–∏–ª—ã —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç –≤–µ—Ç—Ä–∞ –∏ –¥–æ–∂–¥—è. –û–¥–Ω–∞–∫–æ –æ–Ω –∏–º–µ–µ—Ç –∫–∞–∫ –ø–ª—é—Å—ã, \
—Ç–∞–∫ –∏ –º–∏–Ω—É—Å—ã –∏ –º–Ω–æ–≥–∏–µ –≤ —Ç–∞–∫–æ–º —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–æ–º —Ä–µ–∂–∏–º–µ —Å–∫–ª–æ–Ω—è—é—Ç—Å—è –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –≤–∞—Ä–∏–∞–Ω—Ç—É, –æ—Å–æ–±–µ–Ω–Ω–æ, –µ—Å–ª–∏ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω—ã –≤—ã–µ–∑–¥—ã –¥–ª–∏–Ω–Ω–µ–µ 2-—Ö —á–∞—Å–æ–≤.
2. –õ–µ–≥–∫–∏–µ –¥–µ–º–∏—Å–µ–∑–æ–Ω–Ω—ã–µ —Ç—É—Ñ–ª–∏ —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç –≤–µ—Ç—Ä–∞ –∏ –≤–ª–∞–≥–∏ —Å –ª–µ–≥–∫–∏–º —É—Ç–µ–ø–ª–µ–Ω–∏–µ–º.

–£—Ç–µ–ø–ª–µ–Ω–∏–µ –≥–æ–ª–æ–≤—ã:

–®–∞–ø–æ—á–∫–∞ –±—É–¥–µ—Ç –æ—á–µ–Ω—å –∫—Å—Ç–∞—Ç–∏, –µ—Å–ª–∏ –≤—ã –Ω–µ —Ö–æ—Ç–∏—Ç–µ –æ—Ç–º–æ—Ä–æ–∑–∏—Ç—å —É—à–∏ —É–∂–µ —á–µ—Ä–µ–∑ 15 –º–∏–Ω—É—Ç –µ–∑–¥—ã.
""")
        elif d < 5 and \
            d >= 0:
            d = ("""
–ï—Å–ª–∏ –Ω–µ–≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ –ø–æ–¥–æ–π—Ç–∏ –∫ –≤—ã–±–æ—Ä—É –æ–¥–µ–∂–¥—ã –≤ —Ç–∞–∫—É—é –ø–æ–≥–æ–¥—É, \
—É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏—è –º–æ–∂–µ—Ç —Ö–≤–∞—Ç–∏—Ç—å –±—É–∫–≤–∞–ª—å–Ω–æ –Ω–∞ –ø–∞—Ä—É –º–∏–Ω—É—Ç, –∞ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –Ω–µ–º–∏–Ω—É–µ–º–æ –∑–∞—Ö–æ—á–µ—Ç—Å—è –¥–æ–º–æ–π –∫ –º–∞–º–µ.

–í–µ—Ä—Ö:

–ë–ª–∏–∂–µ –∫ –Ω—É–ª—é –ø–æ –¶–µ–ª—å—Å–∏—é –≤–∞–º –≤—Å—ë —Å–∏–ª—å–Ω–µ–µ –∑–∞—Ö–æ—á–µ—Ç—Å—è –±–æ–ª–µ–µ —Ç–µ–ø–ª—É—é –∫—É—Ä—Ç–∫—É, —á–µ–º –≤—ã –Ω–∞–¥–µ–≤–∞–ª–∏ –ø—Ä–∏ +5-10. \
–≠—Ç–∞ –∫—É—Ä—Ç–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å –≤–∏–Ω–¥—Å—Ç–æ–ø–ø–µ—Ä–æ–º –∏ –∏–º–µ—Ç—å –ª–µ–≥–∫–∏–π ¬´–Ω–∞—á–µ—Å¬ª —á—Ç–æ–±—ã –ª—É—á—à–µ —É–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∫–æ–º—Ñ–æ—Ä—Ç–Ω—É—é —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É —Ç–µ–ª–∞.
–ü—Ä–∏ —ç—Ç–æ–º –Ω–∏ –≤ –∫–æ–µ–º —Å–ª—É—á–∞–µ –Ω–µ –≤–∑–¥—É–º–∞–π—Ç–µ –Ω–∞–¥–µ–≤–∞—Ç—å –ø—É—Ö–æ–≤–∏–∫ –∏–ª–∏ —á—Ç–æ-—Ç–æ –≤ —ç—Ç–æ–º —Ä–æ–¥–µ. \
–ö—É—Ä—Ç–∫–∞ –¥–æ–ª–∂–Ω–∞ ¬´–¥—ã—à–∞—Ç—å¬ª, –Ω–æ –Ω–µ –ø—Ä–æ–º–æ–∫–∞—Ç—å. –í–æ–∑–º–æ–∂–Ω–æ, –±–ª–∏–∂–µ –∫ 0¬∞–°, –≤—ã –∑–∞—Ö–æ—Ç–∏—Ç–µ –Ω–∞–¥–µ—Ç—å –ª–µ–≥–∫—É—é —Ñ–ª–∏—Å–∫—É –ø–æ–¥ –∫—É—Ä—Ç–∫—É.
–ù—É –∏, –∫–æ–Ω–µ—á–Ω–æ, –Ω–µ –∑–∞–±—ã–≤–∞–µ–º –æ —Ç–µ—Ä–º–æ—Ñ—É—Ç–±–æ–ª–∫–µ —Å –¥–ª–∏–Ω–Ω—ã–º —Ä—É–∫–∞–≤–æ–º. –ë–µ–∑ –Ω–µ–µ –Ω–∞ –≤–µ–ª–æ—Å–∏–ø–µ–¥–µ –≤ –ø—Ä–æ—Ö–ª–∞–¥–Ω—É—é –ø–æ–≥–æ–¥—É –≤–æ–æ–±—â–µ –¥–µ–ª–∞—Ç—å –Ω–µ—á–µ–≥–æ!

–ù–∏–∑:

–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –Ω–∞ —Ç–∞–∫—É—é –ø–æ–≥–æ–¥—É ‚Äì –∑–∏–º–Ω–∏–µ —à—Ç–∞–Ω—ã —Å –≤–∏–Ω–¥—Å—Ç–æ–ø–ø–µ—Ä–æ–º –∏ —Ç–æ–Ω–∫–∏–º —Å–ª–æ–µ–º —Ñ–ª–∏—Å–æ–≤–æ–≥–æ —É—Ç–µ–ø–ª–∏—Ç–µ–ª—è.
–ö—Å—Ç–∞—Ç–∏, –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –Ω–∞–¥–µ–≤–∞–π—Ç–µ —Ç–µ—Ä–º–æ–±–µ–ª—å–µ –ø–æ–¥ –≤–µ–ª–æ–æ–¥–µ–∂–¥—É —Å –ø–∞–º–ø–µ—Ä—Å–æ–º. \
–ü—Ä–æ—Å—Ç–æ –Ω–µ –¥–µ–ª–∞–π—Ç–µ —ç—Ç–æ–≥–æ, –µ—Å–ª–∏ –Ω–µ —Ö–æ—Ç–∏—Ç–µ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å—Å—è –¥–æ–º–æ–π —Å—Ç–æ—è üòâ

–ü–µ—Ä—á–∞—Ç–∫–∏:

–¢–µ–ø–ª—ã–µ –∑–∏–º–Ω–∏–µ –ø–µ—Ä—á–∞—Ç–∫–∏ —Å –≤–∏–Ω–¥—Å—Ç–æ–ø–ø–µ—Ä–æ–º. –í –±–æ–ª–µ–µ –ª–µ–≥–∫–∏—Ö –≤—ã –∏–º–µ–µ—Ç–µ –≤—Å–µ —à–∞–Ω—Å—ã \
–æ—Ç–º–æ—Ä–æ–∑–∏—Ç—å —Å–µ–±–µ –ø–∞–ª—å—Ü—ã –∏ –ø–ª—é–Ω—É—Ç—å –Ω–∞ –≤—Å–µ —ç—Ç—É –∑–∏–º–Ω—é—é –µ–∑–¥—É –Ω–∞ –≤–µ–ª–æ—Å–∏–ø–µ–¥–µ.

–ó–∞—â–∏—Ç–∞ –≥–æ–ª–æ–≤—ã:

–û—á–µ–Ω—å –≤–∞–∂–Ω–æ –≤ —Ç–∞–∫—É—é –ø–æ–≥–æ–¥—É –∑–∞—â–∏—â–∞—Ç—å —É—à–∏. –û–Ω–∏ –Ω–µ —Ç–æ–ª—å–∫–æ –æ—á–µ–Ω—å —Å–∏–ª—å–Ω–æ –º–µ—Ä–∑–Ω—É—Ç –Ω–∞ —Ö–æ–ª–æ–¥–Ω–æ–º –≤–µ—Ç—Ä—É. \
–ö—Ä–æ–º–µ —ç—Ç–æ–≥–æ, –≤—ã –∏–º–µ–µ—Ç–µ –æ—Ç–ª–∏—á–Ω—ã–µ —à–∞–Ω—Å—ã –ø–æ–¥—Ö–≤–∞—Ç–∏—Ç—å –≤–æ—Å–ø–∞–ª–µ–Ω–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —á–∞—Å—Ç–µ–π —É—Ö–∞, \
–ø–æ–∫–∞—Ç–∞–≤—à–∏—Å—å –≤ —Ö–æ–ª–æ–¥–Ω—É—é –≤–µ—Ç—Ä–µ–Ω–Ω—É—é –ø–æ–≥–æ–¥—É –±–µ–∑ –∑–∞—â–∏—Ç—ã.
–û–¥–∏–Ω –ø–æ—Ö–æ–¥ –∫ –õ–û–†-—É, –∞ –ø–æ—Ç–æ–º –≤ –∞–ø—Ç–µ–∫—É –∑–∞ –ª–µ–∫–∞—Ä—Å—Ç–≤–∞–º–∏ –æ–±—Ö–æ–¥–∏—Ç—Å—è –¥–æ—Ä–æ–∂–µ –æ—Ç–ª–∏—á–Ω–æ–π —à–∞–ø–æ—á–∫–∏, \
–∫–æ—Ç–æ—Ä–∞—è –∑–∞—â–∏—Ç–∏—Ç –≤–∞—à—É –≥–æ–ª–æ–≤—É –∏ —É—à–∏ –∑–∏–º–æ–π! –ù–µ —ç–∫–æ–Ω–æ–º—å—Ç–µ –Ω–∞ –∑–¥–æ—Ä–æ–≤—å–µ!

–ö—Å—Ç–∞—Ç–∏, –≥–¥–µ-—Ç–æ –≤ —Ç–∞–∫—É—é –ø–æ–≥–æ–¥—É —É–∂–µ –º–æ–∂–Ω–æ –∑–∞–¥—É–º–∞—Ç—å—Å—è –æ –ª–µ–≥–∫–æ–π ¬´–±–∞–ª–∞–∫–ª–∞–≤–µ¬ª, \
–∫–æ—Ç–æ—Ä–∞—è –∫—Ä–æ–º–µ —É—à–µ–π –∏ –≤–µ—Ä—Ö–Ω–µ–π —á–∞—Å—Ç–∏ –≥–æ–ª–æ–≤—ã, –ø–æ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–π –ø–æ–¥ –≤–µ—Ç–µ—Ä, –∑–∞—â–∏—â–∞–µ—Ç —à–µ—é.

–ù–æ–≥–∏:

–ï—Å–ª–∏ –≤—ã –Ω–µ –∫—É–ø–∏–ª–∏ —É—Ç–µ–ø–ª–µ–Ω–Ω—É—é –æ–±—É–≤—å, —Å–∞–º–æ–µ –≤—Ä–µ–º—è –∑–∞–¥—É–º–∞—Ç—å—Å—è –æ –Ω–µ–π! \
–ò–ª–∏ –∫—É–ø–∏—Ç—å —Ç–µ–ø–ª—ã–µ –Ω–µ–æ–ø—Ä–µ–Ω–æ–≤—ã–µ –±–∞—Ö–∏–ª—ã. –ï—Å–ª–∏ –≤ +5¬∞–° –∏ –±–æ–ª–µ–µ –º–Ω–æ–≥–∏–µ –µ—â–µ –µ–∑–¥—è—Ç –≤ –ª–µ—Ç–Ω–µ–π –æ–±—É–≤–∏ –±–µ–∑ –∑–∞—â–∏—Ç—ã, \
—Ç–æ –æ–∫–æ–ª–æ –Ω—É–ª—è —Å–¥–∞—é—Ç—Å—è –ø–æ—á—Ç–∏ –≤—Å–µ.
–ü—Ä–∏ –µ–∑–¥–µ –≤ –ª–µ—Ç–Ω–µ–π –æ–±—É–≤–∏ –ø–æ–¥ –Ω–µ–æ–ø—Ä–µ–Ω–æ–≤—ã–º–∏ –±–∞—Ö–∏–ª–∞–º–∏ —á–∞—Å—Ç–æ –º–µ—Ä–∑–Ω–µ—Ç —Å—Ç–æ–ø–∞ —á–µ—Ä–µ–∑ \
–¥—ã—Ä–∫–∏ –¥–ª—è –∫—Ä–µ–ø–ª–µ–Ω–∏—è —à–∏–ø–∞ –ø–æ–¥–æ—à–≤–µ. –ß–∞—Å—Ç–∏—á–Ω–æ —Å–∏—Ç—É–∞—Ü–∏—é –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ª–æ–µ–≤ —Ñ–æ–ª—å–≥–∏ –ø–æ–¥ —Å—Ç–µ–ª—å–∫—É.
""")
        elif d < 0:
            d = ("""
–í–µ—Ä—Ö:

–ó–∏–º–Ω—è—è –∫—É—Ä—Ç–∫–∞ —Å –≤–∏–Ω–¥—Å—Ç–æ–ø–ø–µ—Ä–æ–º –∏ —É—Ç–µ–ø–ª–µ–Ω–∏–µ–º ‚Äì –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –∞—Ç—Ç—Ä–∏–±—É—Ç –≤ —Ç–∞–∫—É—é –ø–æ–≥–æ–¥—É. \
–ü–æ–¥ –Ω–µ–π ‚Äì —Ñ–ª–∏—Å–∫–∞ –ø–æ –ø–æ–≥–æ–¥–µ –∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Ç–µ—Ä–º–æ–±–µ–ª—å–µ —Å –¥–ª–∏–Ω–Ω—ã–º —Ä—É–∫–∞–≤–æ–º.

–ù–∏–∑:

–ó–∏–º–Ω–∏–µ –≤–µ–ª–æ—à—Ç–∞–Ω—ã. –¢–∞–∫–∂–µ, –≤–æ–∑–º–æ–∂–Ω–æ, –≤–∞–º –ø–æ–Ω—Ä–∞–≤–∏—Ç—Å—è –∏–¥–µ—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —É—Ç–µ–ø–ª–∏—Ç—å –∫–æ–ª–µ–Ω–∏ (–æ–Ω–∏-—Ç–æ —É–∂ —Ç–æ—á–Ω–æ –±—É–¥—É—Ç –Ω–µ –ø—Ä–æ—Ç–∏–≤!).

–ü–µ—Ä—á–∞—Ç–∫–∏:

–¢–µ–ø–ª—ã–µ –ø–µ—Ä—á–∞—Ç–∫–∏ —Å –≤–∏–Ω–¥—Å—Ç–æ–ø–ø–µ—Ä–æ–º. –•–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞—é—Ç –ø–µ—Ä—á–∞—Ç–∫–∏ –¥–ª—è –±–µ–≥–æ–≤—ã—Ö –ª—ã–∂. \
–í —Ç–∞–∫—É—é –ø–æ–≥–æ–¥—É –ø–∞–ª—å—Ü—ã —Ä—É–∫ ‚Äì –æ–¥–Ω–∞ –∏–∑ —Å–∞–º—ã—Ö –Ω–µ–∂–Ω—ã—Ö —á–∞—Å—Ç–µ–π —Ç–µ–ª–∞. –ü—Ä–æ–º–µ—Ä–∑–∞—é—Ç –æ–Ω–∏ –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ –∏, \
–µ—Å–ª–∏ –Ω–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö –ø–µ—Ä—á–∞—Ç–æ–∫, –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç.

–ù–∞ –Ω–æ–≥–∏:

–ó–∏–º–Ω–∏–µ –±–æ—Ç–∏–Ω–∫–∏. –¢–æ—á–∫–∞. –ò–≥—Ä—ã —Å –ª–µ—Ç–Ω–µ–π –æ–±—É–≤—å—é –∏ –±–∞—Ö–∏–ª–∞–º–∏ –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –¥–ª—è \
–∫–æ—Ä–æ—Ç–∫–∏—Ö —à–æ—Å—Å–µ–π–Ω—ã—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫. –ó–¥–µ—Å—å –±–∞—Ö–∏–ª—ã –º–æ–≥—É—Ç —Å—ã–≥—Ä–∞—Ç—å —Å –≤–∞–º–∏ –∑–ª—É—é —à—É—Ç–∫—É, \
–æ—Å–æ–±–µ–Ω–Ω–æ, –µ—Å–ª–∏ –≤—ã —É–º—É–¥—Ä–∏—Ç–µ—Å—å –≤—Å—Ç—É–ø–∏—Ç—å –≤ –ª—É–∂—É –∏–ª–∏ –º–æ–∫—Ä—ã–π —Å–Ω–µ–≥.

–í —Ä—é–∫–∑–∞–∫–µ:

–¢–µ—Ä–º–æ—Å —Å –≥–æ—Ä—è—á–∏–º —á–∞–µ–º, –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∫—É—Ä—Ç–∫–∞ –Ω–∞ —Å–ª—É—á–∞–π –∞–≤–∞—Ä–∏–π–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏, –∑–∞–ø–∞—Å–Ω—ã–µ —Ç–µ–ø–ª—ã–µ –ø–µ—Ä—á–∞—Ç–∫–∏.

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:

–¢–µ—Ä–º–æ—Ñ–ª—è–≥–∞ –∏ –≥–∏–¥—Ä–∞—Ç–æ—Ä –ø–æ–¥ –æ–¥–µ–∂–¥–æ–π. –ü—Ä–∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞—Ö –≤–æ–¥–∞ –≤–æ \
—Ñ–ª—è–≥–µ –º–æ–∂–µ—Ç –∑–∞–º–µ—Ä–∑–Ω—É—Ç—å –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ –±—ã—Å—Ç—Ä–æ. –ù–µ –≥–æ–≤–æ—Ä—è —É–∂–µ –æ —Ç–æ–º, —á—Ç–æ —á–µ—Ä–µ–∑ 15-20 –º–∏–Ω—É—Ç \
–µ–∑–¥—ã –æ–Ω–∞ —Å—Ç–∞–Ω–µ—Ç —Å–ª–∏—à–∫–æ–º —Ö–æ–ª–æ–¥–Ω–æ–π, —á—Ç–æ–±—ã –µ—ë –º–æ–∂–Ω–æ –±—ã–ª–æ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ –ø–∏—Ç—å. –ó–∞–¥—É–º–∞–π—Ç–µ—Å—å –æ–± —ç—Ç–æ–º –¥–æ –≤—ã–µ–∑–¥–∞!
""")
        else:
            d = ("""
–í —Ç–∞–∫—É—é –ø–æ–≥–æ–¥—É –Ω—É–∂–Ω–æ –Ω–∞–¥–µ–≤–∞—Ç—å –Ω–∞ —Å–µ–±—è –ª–µ—Ç–Ω–∏–µ –≤–µ–ª–æ—Ç—Ä—É—Å—ã —Å –ø–∞–º–ø–µ—Ä—Å–æ–º, \
–¥–∂–µ—Ä—Å–∏ —Å –∫–æ—Ä–æ—Ç–∫–∏–º —Ä—É–∫–∞–≤–æ–º, –ª–µ–≥–∫–∏–µ –ø–µ—Ä—á–∞—Ç–∫–∏, –ª–µ–≥–∫–∏–µ –Ω–æ—Å–∫–∏ –∏, –∫–æ–Ω–µ—á–Ω–æ, —à–ª–µ–º.
""")
        # await message.answer (w.rain)                    # {}
        # await message.answer (w.heat_index)              # None
        # await message.answer (w.clouds)                  # 75
        await message.answer(str(a.upper()) + "\n\n" + c + "\n" + str(d))
        print(now, message.from_user.first_name + ' –∑–∞–ø—Ä–æ—Å–∏–ª –ø–æ–≥–æ–¥—É –≤ ' + data['city'])
    except:
        await message.reply(
            "–¢—ã —á—Ç–æ –º–Ω–µ —Ç—É—Ç –≤–≤–æ–¥–∏—à—å?\n–ß—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å –ø–æ–≥–æ–¥—É –Ω–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É –ø–æ–≥–æ–¥—ã –∏ –≤–≤–µ–¥–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞."
            )
        print(now, message.from_user.first_name + ' –ø–æ–ø—Ä–æ–±–æ–≤–∞–ª –∑–∞–ø—Ä–æ—Å–∏—Ç—å –ø–æ–≥–æ–¥—É –≤ ' + data['city'] + ', –Ω–æ –Ω–µ —Å–º–æ–≥')
        await state.finish()
        # answer = forecast.will_be_clear_at(timestamps.tomorrow())
    # await message.reply(data['city'])
    await state.finish()


def register_handlers_weather(dp:Dispatcher):
    dp.register_message_handler(weather, commands=['–ü–æ–≥–æ–¥–∞'])
    dp.register_message_handler(city, content_types=['text'], state=FSMWeather.city)